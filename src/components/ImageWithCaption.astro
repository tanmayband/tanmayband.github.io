---
import type { ImageMetadata } from "astro";
import { Image } from "astro:assets";

interface Props {
	src: string | ImageMetadata;
	alt: string;
	width?: number;
	height?: number;
	class?: string;
}

const { src, alt = "", width, height } = Astro.props as Props;

if (typeof src === "string") {
	if (typeof width !== "number" || typeof height !== "number") {
		throw new Error(
			"ImageWithCaption: when src is a string you must pass numeric width and height, or pass an imported ImageMetadata object.",
		);
	}
}
---

<figure class="img-caption-container rounded-box">
	{
		typeof src === "string" ? (
			<Image src={src} alt={alt} width={width!} height={height!} />
		) : (
			<Image src={src} alt={alt} />
		)
	}
	{alt && <figcaption class="caption">{alt}</figcaption>}
</figure>

<style>
	.img-caption-container {
		margin-bottom: 1rem;
		background: var(--gradient-subtle);

		img {
			border-radius: initial;
			border: none;
		}
	
		.caption {
			text-align: center;
			color: var(--accent-dark);
			margin: 0.5rem;
			font-size: var(--text-base);
		}
	}
</style>
